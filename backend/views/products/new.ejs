<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Nuevo Producto</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <% 
    formData = typeof formData !== 'undefined' ? formData : {};
    errors = typeof errors !== 'undefined' ? errors : [];
    categories = typeof categories !== 'undefined' ? categories : [];
  %>

  <div class="container vintage mt-5">
    <h1>Agregar nuevo producto</h1>
    <form action="/products" method="POST">

      <div class="mb-3">
        <label class="form-label">Nombre*</label>
        <input type="text" name="name" class="form-control" required
               value="<%= formData.name || '' %>">
        <% if (errors.length > 0) {
             const errName = errors.find(e => e.param === 'name');
             if (errName) { %>
          <div class="text-danger mt-1"><%= errName.msg %></div>
        <% } } %>
      </div>

      <div class="mb-3">
        <label class="form-label">Precio por pieza*</label>
        <input type="number" step="0.01" name="pricePieza" class="form-control" required
               value="<%= formData.pricePieza || '' %>">
        <% if (errors.length > 0) {
             const errPrice = errors.find(e => e.param === 'pricePieza');
             if (errPrice) { %>
          <div class="text-danger mt-1"><%= errPrice.msg %></div>
        <% } } %>
      </div>

      <div class="mb-3">
        <label class="form-label">Precio mayoreo</label>
        <input type="number" step="0.01" name="priceMayoreo" class="form-control"
               value="<%= formData.priceMayoreo || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Precio paquete (opcional)</label>
        <input type="number" step="0.01" name="pricePaquete" class="form-control"
          value="<%= formData.pricePaquete || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Precio 4 (opcional)</label>
        <input type="number" step="0.01" name="price4" class="form-control"
          value="<%= formData.price4 || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Precio 5 (opcional)</label>
        <input type="number" step="0.01" name="price5" class="form-control"
          value="<%= formData.price5 || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Cantidad m√≠nima para mayoreo (opcional)</label>
        <input type="number" min="0" name="minMayoreo" class="form-control"
          value="<%= formData.minMayoreo || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Cantidad m√≠nima para paquete (opcional)</label>
        <input type="number" min="0" name="minPaquete" class="form-control"
          value="<%= formData.minPaquete || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Cantidad m√≠nima para precio 4 (opcional)</label>
        <input type="number" min="0" name="min4" class="form-control"
          value="<%= formData.min4 || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Cantidad m√≠nima para precio 5 (opcional)</label>
        <input type="number" min="0" name="min5" class="form-control"
          value="<%= formData.min5 || '' %>">
      </div>

          <div class="mb-3">
        <label class="form-label">Categor√≠a*</label>
        <input 
          type="text" 
          name="category" 
          class="form-control" 
          required
          minlength="3"
          value="<%= formData.category || '' %>"
          placeholder="Escribe la categor√≠a"
        >
        <% if (errors.length > 0) {
            const errCategory = errors.find(e => e.param === 'category');
            if (errCategory) { %>
          <div class="text-danger mt-1"><%= errCategory.msg %></div>
        <% } } %>
      </div>

      <div class="mb-3">
        <label class="form-label">Stock</label>
        <input type="number" name="stock" min="0" class="form-control"
               value="<%= formData.stock || 0 %>">
      </div>

      <div class="mb-3">
        <label class="form-label">C√≥digo de barras</label>
        <input type="text" name="barcode" class="form-control"
               value="<%= formData.barcode || '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">Descripci√≥n</label>
        <textarea name="description" class="form-control" rows="2"><%= formData.description || '' %></textarea>
      </div>

      <button class="btn btn-success">üíæ Guardar</button>
      <a href="/products" class="btn btn-secondary">Cancelar</a>
    </form>
  </div>
</body>
</html>
